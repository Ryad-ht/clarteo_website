# Protection du dossier uploads - Clartéo Lab

# Désactivation du listing des répertoires
Options -Indexes

# Interdiction complète de l'exécution de scripts
<FilesMatch "\.(php|php3|php4|php5|phtml|pl|py|jsp|asp|sh|cgi|exe|bat|com|scr|vbs|js|jar|class)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Autorisation uniquement des fichiers CSV
<FilesMatch "\.csv$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# Interdiction de l'accès aux fichiers cachés
<FilesMatch "^\.">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Protection contre l'inclusion de fichiers
<IfModule mod_php5.c>
    php_flag engine off
</IfModule>
<IfModule mod_php7.c>
    php_flag engine off
</IfModule>
<IfModule mod_php8.c>
    php_flag engine off
</IfModule>

# Headers de sécurité
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set X-Robots-Tag "noindex,nofollow"
</IfModule>

# Force le type MIME pour les CSV
<IfModule mod_mime.c>
    AddType text/csv .csv
    AddType application/octet-stream .csv
</IfModule>